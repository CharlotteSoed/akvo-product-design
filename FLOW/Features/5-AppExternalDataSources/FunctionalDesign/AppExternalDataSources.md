App external data sources - Functional design
----------------------------------------------


### Overview
Android phones are capable of many things beyond taking a GPS reading and a photograph. Multiple organisations are creating specialised apps, sometimes with extra hardware attached to the phone, to do a range of measurements, such as distance, vibration, sound level, angle, water quality, and others.

This feature will enable Akvo FLOW to use measurements from such devices as part of the regular survey work flow.

As a first implementation, we create a link between Akvo FLOW and the Caddisfly water quality app of our partner Ternup (http://ternup.com/) 

### Marketing description
**Measure water quality directly from a FLOW Survey**
Android phones are capable of many things beyond taking a GPS reading and a photograph. Many specialised apps are being created to do a range of measurements such as distance, vibration, sound level, angle, and others. Akvo has partnered with India-based startup Ternup, who have created a simple android-phone based measurement device called Caddisfly, capable of taking water quality measurements such as nitrogen and fluoride levels. 

By simply creating a question of the right type on the FLOW Dashboard, you will get a button on the FLOW survey when it is displayed on the device, which takes you straight to the Caddisfly water quality app. There, you can perform the measurement and return to the FLOW app, which makes sure the data is stored and submitted together with the rest of the survey. On the Dashboard, the water quality data as generated by the Caddisfly app then simply shows up as one of the data columns.

### Initial features
* A flag on a free text question will specify 'get measurement from external source'
* On the app, a free text textfield will be shown, plus a button "get from external source"
* The resulting data is stored in the free text field, and processed as usual


### Non goals
* Data recieved will be stored in a packed string (for example "type: NITROGEN, value: 30.2" ), this version will not unpack that yet.
* In this version, we will not support other ways to connect to devices, such as bluetooth, usb.

### Scenarios
**Scenario 1 - water quality measurements**
The user has the Caddisfly app installed, which can perform water quality tests using some specialised phone-attached hardware. The user wants to create a question in FLOW, so the data from the water quality app can be read straight into a FLOW survey. 

### User Experience 
1. The project manager creates a survey on the FLOW Dashboard. In it, she includes a free text question with the title 'Water quality measurement'. In the tooltip, she puts some instructions on how to hangle the Caddishfly app. She checks the checkbox 'get measurement from external source'
2. The project manager assigns the survey to a device
3. The enumerator opens the FLOW app, downloads the survey, and starts a new survey
4. The question 'Water quality measurement' appears as a standard text field, with an extra 'external source' button
5. The enumerator presses the button
6. The FLOW app hands control to the Caddisfly app, which gives instructions to the enumerator on what to do next
7. Following the instructions on the Caddisfly app, the enumerator completes the measurement, and clicks 'save result', or some other button that indicates a return to the FLOW app.
8. The value received from the Caddisfly app is stored in the free text field, and the survey is submitted after other questions have been completed.
9. On the Dashboard, the measurement value is available as an answer to the 'Water quality measurement' question. 


### Open issues
* how to make a more generic link, for apps that we are not affiliated to.
